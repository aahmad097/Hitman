# setup
create database hitman;
create user hitman with encrypted password 'hitman';
grant all privileges on database hitman to hitman;


# database stuff
## operator section

CREATE SCHEMA operators;
CREATE TABLE OPERATORS.OPERATORS(ID INT PRIMARY KEY, USERNAME TEXT NOT NULL, ROLE TEXT NOT NULL, PWDHASH TEXT NOT NULL, SESSIONHASH CHAR(40), SESSIONEXP BIGINT);
INSERT INTO OPERATORS.OPERATORS(ID, USERNAME, ROLE, PWDHASH) VALUES(1,'admin','admin','$2a$04$iX7uWnSbBHd8JzK9YVZfueilrd7gqk5t2ENIrSwN0txiOArcN4Z3i');

## implant section

CREATE SCHEMA sessions;
CREATE TABLE SESSIONS.SESSIONS( ID INT PRIMARY KEY, SESSIONID CHAR(32) NOT NULL, IMPLANTTYPE TEXT NOT NULL, IP INET NOT NULL, COMPUTERNAME TEXT NOT NULL, USERNAME TEXT NOT NULL, DOMAIN TEXT, ENCRYPTIONKEY CHAR(40));
CREATE TABLE SESSIONS.TASKING(ID INT PRIMARY KEY, SESSIONID CHAR(32) NOT NULL, TASKID INT NOT NULL, COMPLETE BOOLEAN NOT NULL, TASK TEXT NOT NULL, RESPONSE TEXT);

